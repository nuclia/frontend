<div class="knowledge-box-processes">
  <div *ngIf="cannotTrain | async" class="warning">
    {{ 'stash.settings.processes.training.not-allowed' | translate }}
  </div>
  <section *ngFor="let type of [trainingTypes.classifier, trainingTypes.labeller]">
    <h2>{{ 'stash.settings.processes.' + type | translate }}</h2>
    <p class="last-run">
      <small>{{ 'stash.settings.processes.training.last_run' | translate: { runDate: lastRun } }}</small>
    </p>

    <div [class.running]="running[type]">
      <p>{{ 'stash.settings.processes.' + type + '.info' | translate }}</p>

      <pa-select
        [label]="'stash.settings.processes.training.select-labelsets' | translate"
        [(value)]="selectedLabelsets[type]"
      >
        <pa-option value="">{{ 'generic.all' | translate }}</pa-option>
        <pa-option *ngFor="let option of labelsets | async" [value]="option.value">{{ option.title }}</pa-option>
      </pa-select>

      <ng-container *ngIf="isBillingEnabled | async">
        <p [class.warning]="!agreement">
          {{ 'stash.settings.processes.training.time_requirement' | translate: { hours: hoursRequired } }}
        </p>

        <div class="agreement-container">
          <pa-checkbox [disabled]="cannotTrain | async"
                       [(value)]="agreement[type]">{{'stash.settings.processes.training.agreement' | translate}}</pa-checkbox>
        </div>
      </ng-container>
    </div>

    <div *ngIf="running[type]" class="active-training warning">
      {{ 'stash.settings.processes.training.active' | translate }}
    </div>
    <div class="cta-container">
      <pa-button [kind]="running[type] ? 'secondary' : 'primary'"
                 [disabled]="(!running[type] && !agreement[type]) || (cannotTrain | async)"
                 (click)="startOrStopTraining(type)">
        {{ 'stash.settings.processes.training.' + (running[type] ? 'stop' : 'start') | translate }}
      </pa-button>
    </div>
  </section>
</div>
