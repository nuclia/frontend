<div class="app-navbar">
  <div class="navbar-scroll-container">
    <div
      *ngIf="!(inAccount | async)"
      class="navbar-content">
      <div class="nav-group">
        <div class="group-items">
          <a
            [routerLink]="kbUrl"
            class="nav-link"
            routerLinkActive="active"
            data-cy="go-to-home"
            [routerLinkActiveOptions]="{ exact: true }">
            <pa-icon name="home"></pa-icon>
            <span class="nav-link-title">{{ 'sidenav.home' | translate }}</span>
          </a>
        </div>
      </div>
      <div class="nav-group">
        <div class="group-items">
          <a
            [routerLink]="(isAdminOrContrib | async) && !(invalidKey | async) ? kbUrl + '/upload' : null"
            class="nav-link"
            routerLinkActive="active"
            data-cy="go-to-upload"
            [routerLinkActiveOptions]="{ exact: true }"
            [class.disabled]="!(isAdminOrContrib | async) || (invalidKey | async)">
            <pa-icon name="upload"></pa-icon>
            <span class="nav-link-title">{{ 'sidenav.upload-data' | translate }}</span>
          </a>
          <a
            class="nav-link"
            data-cy="go-to-search"
            routerLinkActive="active"
            [routerLink]="!(invalidKey | async) ? kbUrl + '/search' : null"
            [class.disabled]="invalidKey | async">
            <pa-icon name="search"></pa-icon>
            <span class="nav-link-title">{{ 'stash.search' | translate }}</span>
          </a>
          <a
            [routerLink]="!(invalidKey | async) ? kbUrl + '/resources' : null"
            routerLinkActive="active"
            class="nav-link"
            data-cy="go-to-resources"
            [class.disabled]="invalidKey | async">
            <pa-icon name="list"></pa-icon>
            <span class="nav-link-title">{{ 'sidenav.list' | translate }}</span>
          </a>
          <a
            [routerLink]="(isAdmin | async) && !(invalidKey | async) ? kbUrl + '/widget-generator' : null"
            routerLinkActive="active"
            class="nav-link"
            data-cy="go-to-widget"
            [class.disabled]="!(isAdmin | async) || (invalidKey | async)">
            <pa-icon name="widget"></pa-icon>
            <span class="nav-link-title">{{ 'sidenav.widgets' | translate }}</span>
          </a>
        </div>
      </div>
      <div class="nav-group">
        <div class="group-items">
          <a
            (click)="toggleSettings()"
            (keyup.enter)="toggleSettings()"
            class="nav-link"
            data-cy="go-to-advanced"
            paFocusable
            [paFocusDisabled]="(isAdminOrContrib | async) === false || (invalidKey | async) === true"
            [class.disabled]="(isAdminOrContrib | async) === false || (invalidKey | async) === true">
            <pa-icon
              name="chevron-right"
              [class.expanded]="showSettings"></pa-icon>
            <span class="nav-link-title">{{ 'sidenav.advanced' | translate }}</span>
          </a>
        </div>
      </div>
      @if (showSettings) {
        <div class="nav-group">
          <div class="group-items">
            <a
              [routerLink]="(isAdmin | async) && !(invalidKey | async) ? kbUrl + '/manage' : null"
              routerLinkActive="active"
              class="nav-link sub-item"
              data-cy="go-to-settings"
              [class.disabled]="!(isAdmin | async) || (invalidKey | async)">
              <pa-icon name="gear"></pa-icon>
              <span class="nav-link-title">{{ 'sidenav.settings' | translate }}</span>
            </a>
            @if (!standalone) {
              @if (isActivityEnabled | async) {
                <a
                  [routerLink]="(isAdminOrContrib | async) ? kbUrl + '/activity/download' : null"
                  routerLinkActive="active"
                  class="nav-link sub-item"
                  data-cy="go-to-activity-log"
                  [class.disabled]="!(isAdminOrContrib | async)">
                  <pa-icon name="activity-log"></pa-icon>
                  <span class="nav-link-title">{{ 'sidenav.activity' | translate }}</span>
                </a>
              }

              @if (isAdmin | async) {
                <a
                  [routerLink]="kbUrl + '/keys'"
                  routerLinkActive="active"
                  data-cy="go-to-api-keys"
                  class="nav-link sub-item">
                  <pa-icon name="lock-off"></pa-icon>
                  <span class="nav-link-title">{{ 'sidenav.api_keys' | translate }}</span>
                </a>
              }
            }

            <a
              [routerLink]="!(invalidKey | async) ? kbUrl + '/label-sets' : null"
              routerLinkActive="active"
              class="nav-link sub-item"
              data-cy="go-to-classification"
              [class.disabled]="invalidKey | async">
              <pa-icon name="label"></pa-icon>
              <span class="nav-link-title">{{ 'sidenav.classification' | translate }}</span>
            </a>
            @if (isEntitiesEnabled | async) {
              <a
                [routerLink]="!(invalidKey | async) ? kbUrl + '/entities' : null"
                routerLinkActive="active"
                class="nav-link sub-item"
                data-cy="go-to-ner"
                [class.disabled]="invalidKey | async">
                <pa-icon name="form"></pa-icon>
                <span class="nav-link-title">{{ 'generic.named-entities' | translate }}</span>
              </a>
            }

            @if (!standalone) {
              @if (isSynonymsEnabled | async) {
                <a
                  [routerLink]="[kbUrl + '/synonyms']"
                  routerLinkActive="active"
                  data-cy="go-to-synonyms"
                  class="nav-link sub-item">
                  <pa-icon name="synonyms"></pa-icon>
                  <span class="nav-link-title">{{ 'sidenav.synonyms' | translate }}</span>
                </a>
              }
              @if (isTrainingEnabled | async) {
                <a
                  [routerLink]="(isAdmin | async) ? kbUrl + '/training' : null"
                  routerLinkActive="active"
                  class="nav-link sub-item"
                  data-cy="go-to-trainings"
                  [class.disabled]="!(isAdmin | async)">
                  <pa-icon name="submenu"></pa-icon>
                  <span class="nav-link-title">{{ 'sidenav.trainings' | translate }}</span>
                </a>
              }
              @if (isAccountManager | async) {
                <a
                  [routerLink]="kbUrl + '/users'"
                  routerLinkActive="active"
                  data-cy="go-to-users"
                  class="nav-link sub-item">
                  <pa-icon name="users"></pa-icon>
                  <span class="nav-link-title">{{ 'sidenav.users' | translate }}</span>
                </a>
              }
            }
          </div>
        </div>
      }
    </div>
    <div
      *ngIf="(inAccount | async) && (isAccountManager | async)"
      class="navbar-content dark">
      <div class="nav-group">
        <div class="group-items">
          <a
            [routerLink]="(accountUrl | async) + '/home'"
            routerLinkActive="active"
            data-cy="go-to-account-home"
            class="nav-link">
            <pa-icon name="home"></pa-icon>
            <span class="nav-link-title">{{ 'sidenav.account-home' | translate }}</span>
          </a>
        </div>
        <div class="group-items">
          <a
            [routerLink]="(accountUrl | async) + '/settings'"
            routerLinkActive="active"
            data-cy="go-to-account-settings"
            class="nav-link">
            <pa-icon name="gear"></pa-icon>
            <span class="nav-link-title">{{ 'sidenav.account-settings' | translate }}</span>
          </a>
        </div>
        <div class="group-items">
          <a
            [routerLink]="(accountUrl | async) + '/kbs'"
            routerLinkActive="active"
            data-cy="go-to-account-kbs"
            class="nav-link">
            <pa-icon name="knowledge-box"></pa-icon>
            <span class="nav-link-title">{{ 'sidenav.manage-kbs' | translate }}</span>
          </a>
        </div>
        <div class="group-items">
          <a
            [routerLink]="(accountUrl | async) + '/users'"
            routerLinkActive="active"
            data-cy="go-to-account-users"
            class="nav-link">
            <pa-icon name="users"></pa-icon>
            <span class="nav-link-title">{{ 'sidenav.users' | translate }}</span>
          </a>
        </div>
        <div class="group-items">
          <a
            [routerLink]="(accountUrl | async) + '/nua'"
            routerLinkActive="active"
            data-cy="go-to-nua-keys"
            class="nav-link">
            <pa-icon name="key"></pa-icon>
            <span class="nav-link-title">{{ 'sidenav.nua-keys' | translate }}</span>
          </a>
        </div>
        <div
          *ngIf="isBillingEnabled | async"
          class="group-items">
          <a
            [routerLink]="(accountUrl | async) + '/billing/subscriptions'"
            routerLinkActive="active"
            data-cy="go-to-billing"
            class="nav-link"
            [class.sub-item]="inBilling | async">
            <pa-icon name="payment"></pa-icon>
            <span class="nav-link-title">{{ 'sidenav.subscription' | translate }}</span>
          </a>
        </div>
        @if ((isSubscribed | async) && (inBilling | async)) {
          <div class="nav-group">
            <div class="group-items">
              <a
                [routerLink]="(accountUrl | async) + '/billing/checkout'"
                routerLinkActive="active"
                data-cy="go-to-checkout"
                class="nav-link sub-item">
                <pa-icon name="payment-details"></pa-icon>
                <span class="nav-link-title">{{ 'billing.payment_details' | translate }}</span>
              </a>
              <a
                [routerLink]="(accountUrl | async) + '/billing/my-subscription'"
                routerLinkActive="active"
                data-cy="go-to-my-subscription"
                class="nav-link sub-item">
                <pa-icon name="info"></pa-icon>
                <span class="nav-link-title">{{ 'billing.my-subscription' | translate }}</span>
              </a>
              <a
                [routerLink]="(accountUrl | async) + '/billing/usage'"
                routerLinkActive="active"
                data-cy="go-to-usage"
                class="nav-link sub-item">
                <pa-icon name="chart"></pa-icon>
                <span class="nav-link-title">{{ 'billing.usage.consumption' | translate }}</span>
              </a>
              <a
                [routerLink]="(accountUrl | async) + '/billing/history'"
                routerLinkActive="active"
                data-cy="go-to-history"
                class="nav-link sub-item">
                <pa-icon name="history"></pa-icon>
                <span class="nav-link-title">{{ 'billing.history.link' | translate }}</span>
              </a>
            </div>
          </div>
        }
        <div
          *ngIf="isSyncEnabled | async"
          class="group-items">
          <a
            [routerLink]="(accountUrl | async) + '/sync'"
            routerLinkActive="active"
            data-cy="go-to-sync"
            class="nav-link">
            <pa-icon name="upload"></pa-icon>
            <span class="nav-link-title">{{ 'sidenav.sync' | translate }}</span>
          </a>
        </div>
      </div>
      <div
        class="nav-group"
        *ngIf="kb | async">
        <div class="group-items">
          <a
            [routerLink]="kbUrl"
            data-cy="go-to-home-from-account"
            class="nav-link">
            <pa-icon name="chevron-left"></pa-icon>
            <span class="nav-link-title">{{ 'generic.back' | translate }}</span>
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
