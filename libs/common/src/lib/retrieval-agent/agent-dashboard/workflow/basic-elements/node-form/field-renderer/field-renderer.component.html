<div [formGroup]="form">
  @switch (fieldConfig.component) {
    <!-- Array string field -->
    @case ('array-string-field') {
      <app-array-string-field
        [form]="form"
        [arrayName]="controlName"
        [label]="label"
        [required]="required"
      [config]="config"></app-array-string-field>
    }
    <!-- Code editor -->
    @case ('code-editor') {
      <app-code-editor
        [form]="form"
        [controlName]="controlName"
        [label]="label"
        [property]="property"
        [required]="required"
        [initialLanguage]="fieldConfig.additionalProps?.['initialLanguage'] || 'javascript'"
        [availableLanguages]="fieldConfig.additionalProps?.['availableLanguages']"
      [showLanguageSelector]="fieldConfig.additionalProps?.['showLanguageSelector'] ?? true"></app-code-editor>
    }
    <!-- Driver select -->
    @case ('driver-select') {
      <app-driver-select
        [label]="label"
        [required]="required"
        [form]="form"
        [controlName]="controlName"
        [provider]="fieldConfig.additionalProps?.['provider']"
      [multiselect]="fieldConfig.additionalProps?.['multiselect']"></app-driver-select>
    }
    <!-- Enum select -->
    @case ('enum-select') {
      <app-enum-select
        [form]="form"
        [controlName]="controlName"
        [label]="label"
        [property]="property"
      [required]="required"></app-enum-select>
    }
    <!-- Filtered Source Select -->
    @case ('filtered-source-select') {
      <app-filtered-source-select
        [form]="form"
        [controlName]="controlName"
        [label]="label"
        [property]="property"
      [required]="required"></app-filtered-source-select>
    }
    <!-- Model select fields -->
    @case ('model-select') {
      <app-model-select
        [label]="label"
        [required]="required"
        [form]="form"
      [controlName]="controlName"></app-model-select>
    }
    <!-- Rules field -->
    @case ('rules-field') {
      <app-rules-field
        [form]="form"
      [config]="config"></app-rules-field>
    }
    <!-- Subform field for $ref properties -->
    @case ('subform-field') {
      <app-subform-field
        [form]="form"
        [controlName]="controlName"
        [label]="label"
        [property]="property"
      [required]="required"></app-subform-field>
    }
    <!-- Transport field -->
    @case ('transport-field') {
      <app-transport-field
        [form]="form"
        [controlName]="controlName"
        [label]="label"
        [property]="property"
      [required]="required"></app-transport-field>
    }
    <!-- Key-value field -->
    @case ('key-value-field') {
      <app-key-value-field
        [form]="form"
        [controlName]="controlName"
        [label]="label"
        [property]="property"
      [required]="required"></app-key-value-field>
    }
    <!-- Synonyms (dictionary of lists) field -->
    @case ('synonyms-field') {
      <app-synonyms-field
        [form]="form"
        [controlName]="controlName"
        [label]="label"
        [property]="property"
      [required]="required"></app-synonyms-field>
    }
    <!-- Text input (includes string, const, and fallback) -->
    @case ('pa-input') {
      <pa-input
        [id]="controlName"
        [formControlName]="controlName"
        [type]="getFieldType()"
        [placeholder]="property.description || ''"
        [help]="property.description || ''"
        [required]="required">
        {{ label }}
        @if (required) {
          <span
            style="color: red">
            *
          </span>
        }
      </pa-input>
    }
    <!-- Expandable Textarea -->
    @case ('expandable-textarea') {
      <nsi-expandable-textarea
        [id]="controlName"
        [formControlName]="controlName"
        [rows]="fieldConfig.additionalProps?.['rows'] || 3"
        [resizable]="fieldConfig.additionalProps?.['resizable'] || false"
        [modalTitle]="label"
        [placeholder]="property.description || ''"
        [required]="required">
        {{ label }}
        @if (required) {
          <span
            style="color: red">
            *
          </span>
        }
      </nsi-expandable-textarea>
    }
    <!-- Boolean toggle -->
    @case ('pa-toggle') {
      <pa-toggle
        [formControlName]="controlName"
        [required]="required"
        withBackground>
        {{ label }}
        @if (required) {
          <span
            style="color: red">
            *
          </span>
        }
      </pa-toggle>
    }
    <!-- Custom placeholder for TODO fields -->
    @case ('custom-placeholder') {
      <div>
        <label>
          <i>[Custom]</i>
          {{ label }}
          @if (required) {
            <span
              style="color: red">
              *
            </span>
          }
        </label>
      </div>
    }
    <!-- Fallback to text input -->
    @default {
      <pa-input
        [id]="controlName"
        [formControlName]="controlName"
        type="text"
        [placeholder]="property.description || ''"
        [help]="property.description || ''"
        [required]="required">
        {{ label }}
        @if (required) {
          <span
            style="color: red">
            *
          </span>
        }
      </pa-input>
    }
  }
</div>
