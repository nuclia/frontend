<div class="page-spacing">
  <header>
    <nsi-back-button [link]="backRoute | async">
      {{ 'tasks-automation.bach-to-tasks' | translate }}
    </nsi-back-button>

    <div>
      @if (task | async; as task) {
        <h1 class="page-title">{{ task.parameters.name }}</h1>
      } @else {
        <h1 class="page-title">{{ 'tasks-automation.type.synthetic-questions.title' | translate }}</h1>
        <p class="page-description">{{ 'tasks-automation.type.synthetic-questions.description' | translate }}</p>
      }
    </div>
  </header>

  @if (task | async; as task) {
    <app-task-settings [task]="task">
      @if (qaOperation | async; as qaOperation) {
        <nsi-two-columns-configuration-item itemTitle="tasks-automation.question-answer.prompts.title">
          <div class="settings-container">
            <div class="setting">
              <label>{{ 'tasks-automation.form.prompts.question-prompt' | translate }}</label>
              <div>{{ qaOperation.question_generator_prompt || '-' }}</div>
            </div>
            <div class="separator-line"></div>
            <div class="setting">
              <label>{{ 'tasks-automation.form.prompts.answer-prompt' | translate }}</label>
              <div>{{ qaOperation.generate_answers_prompt || '-' }}</div>
            </div>
          </div>
        </nsi-two-columns-configuration-item>
      }
    </app-task-settings>
  } @else {
    <app-task-form
      [type]="type"
      triggerDescription="tasks-automation.question-answer.trigger-description"
      activateButtonLabel="tasks-automation.question-answer.footer.activate-button-label"
      footerNoteAutomation="tasks-automation.question-answer.footer.apply-automation"
      footerNoteOneTime="tasks-automation.question-answer.footer.apply-one-time"
      [validFormInside]="questionAnswerForm.valid"
      (activate)="activateTask($event)"
      (cancel)="backToTaskList()">
      <div>
        <nsi-two-columns-configuration-item
          itemTitle="tasks-automation.question-answer.prompts.title"
          description="tasks-automation.question-answer.prompts.description"
          badge="generic.badge.optional">
          <div class="form-container">
            <div [formGroup]="questionAnswerForm">
              <div class="form-container">
                <pa-textarea
                  formControlName="question_generator_prompt"
                  rows="3">
                  {{ 'tasks-automation.form.prompts.question-prompt' | translate }}
                </pa-textarea>
                <pa-textarea
                  formControlName="generate_answers_prompt"
                  rows="3">
                  {{ 'tasks-automation.form.prompts.answer-prompt' | translate }}
                </pa-textarea>
              </div>
            </div>
          </div>
        </nsi-two-columns-configuration-item>
      </div>
    </app-task-form>
  }
</div>
