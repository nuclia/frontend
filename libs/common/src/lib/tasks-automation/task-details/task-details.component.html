<div class="page-spacing">
  <header>
    <nsi-back-button [link]="backRoute | async">
      {{ 'tasks-automation.bach-to-tasks' | translate }}
    </nsi-back-button>
    @if (task | async; as task) {
      <div class="title">
        <h1 class="page-title">{{ task.parameters?.name }}</h1>
        <div class="actions">
          <pa-button
            aspect="basic"
            [disabled]="task.applyOption !== 'NEW'"
            (click)="modifyTask()">
            {{ 'tasks-automation.actions.edit.edit-configuration' | translate }}
          </pa-button>
        </div>
      </div>
    }
  </header>

  <pa-tabs notFullWidth>
    <pa-tab
      (click)="selectedTab = 'configuration'"
      [active]="selectedTab === 'configuration'">
      {{ 'tasks-automation.tab.configuration' | translate }}
    </pa-tab>
    @if (tasksSupportingTesting.includes((task | async)?.task?.name || 'ask')) {
      <pa-tab
        (click)="selectedTab = 'testing'"
        [active]="selectedTab === 'testing'">
        {{ 'tasks-automation.tab.testing' | translate }}
      </pa-tab>
    }
  </pa-tabs>

  @switch (selectedTab) {
    @case ('configuration') {
      <app-task-settings [task]="(task | async) || undefined"></app-task-settings>
    }
    @case ('testing') {
      <app-task-testing [task]="(task | async) || undefined"></app-task-testing>
    }
  }
</div>
